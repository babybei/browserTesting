<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>检测浏览器</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="apple-touch-icon" href="apple-touch-icon.png">
	<!-- Place favicon.ico in the root directory -->

	<!-- build:css styles/vendor.css -->
	<!-- bower:css -->
	<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.css" />
	<!-- endbower -->
	<!-- endbuild -->

	<!-- build:css styles/main.css -->
	<link rel="stylesheet" href="styles/header.css">
	<link rel="stylesheet" href="styles/testing.css">
	<!-- endbuild -->

	<!-- build:js scripts/vendor/modernizr.js -->
	<script src="../bower_components/modernizr/modernizr.js"></script>
	<!-- endbuild -->
    <script src="../bower_components/requirejs/require.js"></script>
    <script src="./video/require_conf.js"></script>
    <script src="./video/speaking_exercise.js"></script>
</head>
<body>
	<!-- header -->
	<div class="header">
		<div class="container containerfirst mainContainer">
			<div class="ik-logo"><a href="/userCenter"><img src="http://static2.kaolawu.com/static/common/img/logo.png"></a></div>
			<ul class="nav nav__menu">
				<li class="page-item usercenter" data-img="none">
					<a href="/userCenter">个人中心</a>
				</li>
				<li class="page-item toefl current" data-img="http://static2.kaolawu.com/static/studymain/img/toefl.jpg"><a href="/toefl">TOEFL</a></li>
				<li class="page-item gre" data-img="http://static2.kaolawu.com/static/studymain/img/gre.jpg"><a href="/gre">GRE</a></li>
				<li class="page-item gmat" data-img="http://static2.kaolawu.com/static/studymain/img/gmat.jpg"><a href="/gmat">GMAT</a></li>
				<li class="page-item logbook" data-img="none"><a href="/logBook">记录本</a></li>
				 
				<input type="hidden" id="stuCode" value="VBJ100086">
				<li class="page-item classroom nav__menu-item">
					<a href="javascript:void(0)">
						<span>课堂</span>
						<i class="icon-sort-down keDown"></i> 
					</a>
				</li>

				<li class="page-item active"></li>
			</ul>
			
			<div class="float-right">
				<div class="welcome">
					<a class="welcome" href="http://passport.kaolawu.com/user/detail">张三</a>
					
				</div>

				<a class="exit" href="http://passport.kaolawu.com/logout?gotoURL=http://www.kaolawu.com/logout">退出</a>
			</div>
		</div>
	</div>
	<!-- 内容 -->
	<div class="container">
		<h1 class="title24">正在对模考环境及设备进行检测......</h1>
		<ul class="result clearfix">
			<li class="iconTest chrome"></li>
			<li class="r-right">
				<div >浏览器检测<div id="browserR" class="iconTest refresh"></div></div>
				<div class="result01" style="display: none;">

				</div>
			</li>
		</ul>
		<ul class="result clearfix micro">
			<li class="iconTest microphone"></li>
			<li class="rr-right"style="margin-bottom: 22px;" >
				<div>麦克风检测
					<span style="font-size:16px;height:35px; display:inline-block;">(点击<img src="./images/recording.gif" style="margin: 0 10px;">时，请仔细检查页面弹框，点击
					<span style="font-weight: 900">允许</span>使用您的摄像机和麦克风)
					</span>
				</div>
			</li>
			<li>
			<input id="recordswf" type="hidden" data-url="./FlashWavRecord/recorder.swf">
				<div class="content content-speak-test">
					<div class="speakContent">
						<div class="mirophone">
							<ul>
								<li class="mirophoneEnTips">
									<img src="./images/Select-Microphone.png" alt="">
								</li>
								<li class="mirophoneOption">
									<form action="">
										<select style="border-radius: 4px; padding-right: 28px; font-weight: 600; font-size: 17px;">
											<option>FlashWavRecorder</option>
										</select>
									</form>
								</li>
								<li class="mirophoneChTips">
									<div class="record-volume-bar lightBlue"></div>
									<div class="microphoneTip">您可以测试麦克风了！</div>
								</li>
							</ul>
						</div>
						<div class="controlButton">
							<ul>
								<li id="recording" class="butBig butInvalid" style="margin-top: 9px;">Recording</li>
								<li id="stop" class="butSmall butInvalid" style="margin-top: 9px;">Stop</li>
								<li id="play"  class="butBig butInvalid">Play</li>
								<li id="retry"  class="butSmall butInvalid">Retry</li>
							</ul>
						</div>
					</div>
				</div>	
				<span id="save_button"> 
					<span id="flashcontent">
						<p>Your browser must have JavaScript enabled and the Adobe Flash
						Player installed.</p>
					</span>
				</span>
			</li>
			<li class="rrr-right">
				<img src="./images/shape.png" style="margin: 0 6px;">录音失败
				<span style="font-size:14px;">
				(听不到声音或者杂音较大)，
				</span>
				 请先检查或者更换耳麦重试。仍然不行，请联系监考或顾问老师
			</li>
			<li class="rrr-right">
				<img src="./images/shape.png" style="margin: 0 6px;">录音正常
				<a class="start" href="/exam/doExam?classCode=${classCode}&studentCode=${studentCode}&classExamId=${classExamId}" target="_self">进入考试 ></a>
			</li>
		</ul>
	</div>
	<!-- build:js scripts/vendor.js -->
	<!-- bower:js -->
	<!-- <script src="../bower_components/jquery/dist/jquery.js"></script> -->
	<!-- endbower -->
	<!-- endbuild -->
	<script type="text/javascript">
	requirejs([ 'jquery', 'audioBar', 'recorder', 'swfobject' ],function ($, audioBar) {
		$(function(){
			var userAgent =navigator.userAgent;
			var b_version=navigator.appVersion;
			var resultHtml='';
			var isSafari = userAgent.indexOf("Safari") > -1 && userAgent.indexOf("Chrome") == -1; //判断是否Safari浏览器  
	      	var isChrome = userAgent.indexOf("Chrome") > -1 && userAgent.indexOf("Safari") > -1; //判断Chrome浏览器 
	      	var browserSure=false;
	      	if (userAgent.indexOf("Chrome") > -1 && userAgent.indexOf("Safari") > -1) {
				// alert("浏览器名称："+"Chrome"+"浏览器版本："+ parseFloat(b_version.split('Chrome/')[1]));
				var chrome_version=parseFloat(b_version.split('Chrome/')[1]);
				if(chrome_version<=53){
					browserSure=true;
				}else{  //浏览器不合格版本地与53
					resultHtml='<p>您的浏览器不符合模考要求，请按提示进行操作：</p><p>1.卸载此浏览器<a class="ab-look" target="_blank" href="http://jingyan.baidu.com/article/00a07f3882097982d028dc18.html">点击查看卸载方式</a></p><p>2.下载并安装指定版本谷歌浏览器</p>';
				}
			}else{  //其他浏览器
				resultHtml='<p>请使用考拉屋模考专用谷歌浏览器，下载地址如下：</p>';
			}
			//系统类型判断
			var bit= GetOSInfo();
			switch(bit){
				case "WOW64":
				resultHtml+='<ul class="platform"><li><div class="iconTest window"></div><p>Windows64位版</p><a class="btn btn-down" href="http://pan.baidu.com/s/1bFd1eQ" target="_blank">立即下载</a></li></ul>';
				break;
				case "WOW32":
				resultHtml+='<ul class="platform"><li><div class="iconTest window"></div><p>Windows32位版</p><a class="btn btn-down" href="http://pan.baidu.com/s/1eR4fUPc" target="_blank">立即下载</a></li></ul>';
				break;
				case "Mac":
				resultHtml+='<ul class="platform"><li><div class="iconTest mac"></div><p>MAC版</p><a class="btn btn-down" href="http://pan.baidu.com/s/1eSl1F02" target="_blank">立即下载</a></li></ul>';
				break;
				default:
				resultHtml+='<ul class="platform"><li><div class="iconTest window"></div><p>Windows32位版</p><a class="btn btn-down" href="http://pan.baidu.com/s/1eR4fUPc" target="_blank">立即下载</a></li><li><div class="iconTest window"></div><p>Windows64位版</p><a class="btn btn-down" href="http://pan.baidu.com/s/1bFd1eQ" target="_blank">立即下载</a></li><li><div class="iconTest mac"></div><p>MAC版</p><a class="btn btn-down" href="http://pan.baidu.com/s/1eSl1F02" target="_blank">立即下载</a></li></ul>';
				break;
			}
			//停止动画
			setTimeout(function(){
				$(".refresh").css('animation-play-state', 'paused');  //动画开始running
				$("#browserR").removeClass('refresh');
				if(browserSure){
					$("#browserR").addClass('right');
					$(".micro").css("display","block");
				}else{
					$("#browserR").addClass('wrong');
					$(".result01").html(resultHtml);
					$(".result01").css("display","block");
				}
			},300);
		});
		//判断系统类型
		function GetOSInfo()
		{ 
			var _pf=navigator.platform; 
			var appVer=navigator.userAgent; 
			if(_pf=="Win32" || _pf == "Windows") 
			{ 
				if(appVer.indexOf("WOW64")>-1)
				{ 
					return "WOW64";   //64位
				}
				else
				{ 
					return "WOW32";   //32位
				} 
			}
			else if(_pf.indexOf("Mac")>-1)
			{ 
				return "Mac"; 
			}
			else
			{ 
				return "Unknow"; 
			} 
		}
	});
	</script>
</body>
</html>